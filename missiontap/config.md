# 配置文件

以下我们会详细解释配置文件中的每一项配置的含义和基本使用方法。

!> 我们暂时还没有加入对配置文件内容的验证逻辑，请严格按照配置文件中的要求进行配置，否则可能导致程序处理混乱。

### weekly-refresh-time

```yml
# 每周任务刷新时间，范围 1~7，对应星期日~星期六
weekly-refresh-time: 1
```

设置每周任务的刷新时间，必须满足 $1\leq{n}\leq{7}$ 且 $n$ 为整数。当该项为 1 时所指的是星期日，以此类推。例如，当该项指定为 `6` 时，代表在每个星期五刷新周任务。

周任务的刷新不会精确到任何小时或分钟，它会根据第一次刷新时的时间来推算下次刷新的时间。例如，当周任务的刷新在某一天的 $m$ 时 $n$ 分被执行，那么下次刷新时间便是下一个星期的指定日的 $m$ 时 $n$ 分。

?> 💡 针对本插件的刷新逻辑的具体讨论，可以参考[刷新逻辑](/missiontap/refresh.md)。

### daily-refresh-time

```yml
# 每日任务刷新时间，范围 0~23，对应二十四小时
daily-refresh-time: 0
```

设置每日任务的刷新时间，必须满足 $0\leq{n}\lt{24}$ 且 $n$ 为整数。当该项为 0 时所指的是凌晨 0 点，以此类推。例如，当该项指定为 15 时，代表在每天的下午三点，或 15 点，刷新日任务。

日任务刷新时间的分钟数必为 0。例如，当日任务被规定为在每天的 $n$ 时执行，那么它的具体执行时间则为每一天的 $n$ 时 0 分。

### weekly-mission-amount

```yml
# 周任务抽取数量
weekly-mission-amount: 4
```

设置周任务的抽取数量，必须为正整数。由于本插件是通过从用户写好的任务中随机抽取进行分配来工作的，因此需要设置该项的值。

若周任务总数小于该值，则每次抽取都会抽取全部周任务来进行分配；若周任务总数大于该值，则每次抽取都会抽取该项所规定数量的任务来进行分配。

### daily-mission-amount

```yml
# 日任务抽取数量
daily-mission-amount: 2
```

同上。

### allow-tarriance

```yml
# 是否允许已接受的周任务在一个月后才过期
# 若为 false，则随周任务刷新而过期（每周一次）
allow-tarriance: false
```

控制是否打开拖延症模式，该模式只会影响到周任务的相关逻辑。当该项关闭时，周任务的过期时间与刷新时间保持一致。例如，若设定周任务在每周五刷新，每个新刷出来的周任务也都会在每周五过期。玩家必须在每次刷新之前把任务做完，否则任务就会消失。

当该项打开时，周任务的过期时间将会被设为玩家在接受该任务时间的月底。例如若在 $m$ 月 $n$ 日接受该任务，那么该任务将在 $m$ 月的最后一天过期。最后一天根据月份进行变动，例如二月是第 28 或 29 天，其余月份是第 30 或 31 天。

!> 即使玩家在倒数第二天接受任务，仍然会在最后一天过期而不会拖到下一个月。

### require-acceptance 

```yml
# 是否需要玩家接受任务后才开始计算
require-acceptance: false
```

控制玩家是否需要手动接受任务。如果该项被关闭，在每次任务刷新的同时，会自动将刷新出的任务内容写入玩家数据中，立即开始统计。玩家不需要打开菜单来接受，而是直接进行任务要求的相关操作即可。

当该项被打开，玩家需要打开相应的任务菜单，点击任务来接受，而后才会开始计算。玩家在未接受任何任务时，所进行的任何操作不会被记录。

?> 💡 针对本插件的任务逻辑的具体讨论，可以参考[任务逻辑](/missiontap/mission.md)

### require-submittion

```yml
# 是否需要玩家提交后才会获得奖励
require-submittion: false
```

控制玩家是否需要手动提交任务。如果该项被关闭，玩家在进行每个与任务有关的操作时，都会实时计算此时是否已经完全满足任务的需求。若满足，则会自动帮玩家提交任务，玩家将会在完成任务的同时收到消息和获得奖励。

当该项被打开，玩家需要打开自己的任务清单，点击任务来提交，而后才会获得任务的奖励。

### allow-cancelling

```yml
# 是否允许玩家取消任务
allow-cancelling: false
```

控制是否允许玩家取消任务。默认情况下，玩家可以在自己的任务清单中 <kbd>Shift</kbd> + <kbd>左键</kbd> 单击某一个任务来取消它。若该项被关闭，玩家将无法取消任务。

取消任务将会删除玩家对于该任务的所有进度。

### allow-multiple-acceptance

```yml
# 是否允许重复接受同一任务
allow-multiple-acceptance: true
```

控制是否允许玩家重复接受同一个任务。若开启，玩家可以在完成当前任务之后（的下一秒）继续接受同一个任务，完成相同的任务内容，获取相同的奖励。若关闭，玩家在完成任务之后必须等待下一次刷新才可再次接受同一任务。对于 `require-acceptance` 被关闭的情况，此项开启时的表现是玩家在完成任务获得奖励后进度被清零；此项关闭时的表现是玩家在完成任务获得奖励之后，任务从已接受任务的菜单中消失，直到下次刷新才会再次出现。

### special-missions

```yml
# 手动开关：是否显示特殊任务
special-missions: false
```

这是一个手动开关，用来设置是否允许玩家查看、接受和完成特殊任务。特殊任务的内容是静态的，且不会被随机抽取，也没有过期时间。特殊任务一经打开，玩家可以在菜单中看到特殊任务，并接受它们。

!> 此项关闭时，所有特殊任务的进度记录将会被暂停。即使有的玩家仍然有没有完成的特殊任务，也无法继续完成，且无法领取奖励。

### time-offset

```yml
# 控制时差，单位小时，必须为整数
# 计算方法：真实时间与服务器时间的差值
time-offset: 0
```

控制插件计算时间的偏移量，用来弥补那些系统时间与玩家时间不相符的服务器的计算错误。该时差将会在插件的每一次时间计算上进行变动。设置为正数则为加，设置为负数则为减。若实际时间为 $t_实$，服务器时间为 $t_服$，那么时间偏移量 $o=t_实 - t_服$。

该项设置后，每次任务刷新时的提示会附带上下次刷新的真实时间（计算后的时间）。

?> **例子**<br>
若服务器的时间总晚于实际时间 8 个小时，例如当实际时间是当天下午 14:00，而服务器时间为当天早上 6:00，那么该项应当设置为 `8`。<br>
若服务器的时间总早于实际时间 24 个小时，例如当实际时间是当天下午 14:00，而服务器时间为下一天的 14:00，那么该项应当设置为 `-24`。<br>

## 配置文件原文

插件在进行数据操作的过程中可能会将配置文件中的注释抹去，该问题*可能*在未来解决。配置文件的原文如下

```yml
# 完整解释参见 https://book.sotap.org/#/missiontap/config
# 每周任务刷新时间，范围 1~7，对应星期日~星期六
weekly-refresh-time: 1
# 每日任务刷新时间，范围 0~23，对应二十四小时
daily-refresh-time: 14
# 周任务抽取数量
weekly-mission-amount: 4
# 日任务抽取数量
daily-mission-amount: 2
# 是否允许已接受的周任务只在月末清空
# 若为 false，则随周任务刷新而清空（每周一次）
allow-tarriance: false
# 是否需要玩家接受任务后才开始计算
require-acceptance: false
# 是否需要玩家提交后才会获得奖励
require-submittion: false
# 是否允许玩家取消任务
allow-cancelling: false
# 是否允许重复接受同一任务
allow-multiple-acceptance: true
# 手动开关：是否显示特殊任务
special-missions: false
# 控制时差，单位小时，必须为整数
# 计算方法：真实时间与服务器时间的差值
time-offset: 0
```

原文会随插件本身进行更新，若发现该原文不符合新版本，请多刷新本页几遍或者[提交 Issue](https://github.com/sotapmc/MissionTap/issues)。